=================================================================
  FULL END-TO-END FLOW TEST
  Register â†’ OTP Verify â†’ Login â†’ Protected Routes
=================================================================
  Test email: flow-test-1772244418182@example.com

â”€â”€ Flow 1: Register â†’ OTP â†’ Login â”€â”€
  âœ… 1.1 Register â†’ 201 â€” status: 201
  âœ… 1.2 requiresEmailVerification = true
  âœ… 1.3 devOtp present in dev mode â€” devOtp: 143600
  âœ… 1.4 JWT token returned
  âœ… 1.5 Set-Cookie: auth_token
  â„¹ï¸  devOtp: 143600
  â„¹ï¸  Frontend should redirect to: /ar/auth/verify-email?email=flow-test-1772244418182%40example.com
  âœ… 1.6 Verify OTP â†’ 200 â€” status: 200
  âœ… 1.7 success = true
  â„¹ï¸  Frontend should redirect to: /ar/auth/login?verified=1
  âœ… 1.8 Login after verify â†’ 200 â€” status: 200
  âœ… 1.9 Login returns user
  âœ… 1.10 Login returns token
  âœ… 1.11 Set-Cookie: auth_token on login
  âœ… 1.12 /api/auth/me with token â†’ 200 â€” status: 200
  âœ… 1.13 Returns correct user email
  âœ… 1.14 Returns correct role

â”€â”€ Flow 2: Redirect URL Verification â”€â”€
  âœ… 2.1 verify-email URL has email param
  âœ… 2.2 login URL has verified=1 param
  âœ… 2.3 email properly encoded â€” encoded: flow-test-1772244418182%40example.com
  â„¹ï¸  verify-email URL: /ar/auth/verify-email?email=flow-test-1772244418182%40example.com
  â„¹ï¸  login URL after verify: /ar/auth/login?verified=1

â”€â”€ Flow 3: Already Verified User â”€â”€
  âœ… 3.1 Already verified â†’ 409 or 429 â€” status: 409 (409=verified, 429=rate-limited)
  â„¹ï¸  Error: This email is already verified.

â”€â”€ Flow 4: Unverified User Login (soft enforcement) â”€â”€
  âœ… 4.1 Register unverified user â†’ 201 â€” status: 201
  âœ… 4.2 Unverified user can login (soft enforcement) â€” status: 200
  â„¹ï¸  Note: Email verification is soft-enforced (user can still login)
  â„¹ï¸  Frontend shows verification reminder in profile/navbar

â”€â”€ Flow 5: Wrong OTP Error Messages â”€â”€
  âœ… 5.1 Wrong OTP â†’ 400 â€” status: 400
  âœ… 5.2 attemptsLeft in response
  â„¹ï¸  Arabic error: Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ ØºÙŠØ± ØµØ­ÙŠØ­. Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: 4
  âœ… 5.3 English error message â€” status: 400
  â„¹ï¸  English error: Invalid verification code. Attempts remaining: 3

â”€â”€ Flow 6: Page Accessibility â”€â”€
  âœ… 6.x Register page (AR) â€” status: 200
  âœ… 6.x Register page (EN) â€” status: 200
  âœ… 6.x Login page (AR) â€” status: 200
  âœ… 6.x Login page with verified=1 â€” status: 200
  âœ… 6.x Verify email page (AR) â€” status: 200
  âœ… 6.x Verify email page (EN) â€” status: 200

=================================================================
  RESULTS: 29 passed, 0 failed out of 29 tests
=================================================================

ğŸ‰ All flow tests passed!

ğŸ“‹ Frontend Flow Summary:
  Register page:
    â€¢ Submits form â†’ calls /api/auth/register
    â€¢ If requiresEmailVerification=true â†’ redirects to /[locale]/auth/verify-email?email=...
    â€¢ Shows toast: "Account created! Please verify your email ğŸ“§"
  Verify Email page:
    â€¢ Shows 6-digit OTP input with auto-advance
    â€¢ 10-minute countdown timer
    â€¢ Resend button with 60s cooldown
    â€¢ On success â†’ redirects to /[locale]/auth/login?verified=1
  Login page:
    â€¢ If ?verified=1 â†’ shows green "Email verified!" banner
    â€¢ Shows toast: "âœ… Email verified! You can now sign in."
    â€¢ "Haven't verified your email yet?" link to verify-email page
